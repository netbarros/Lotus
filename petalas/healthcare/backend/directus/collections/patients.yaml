# PÃ©tala Healthcare - Patients Collection
# Patient demographics and core information

collections:
  - collection: patients
    meta:
      group: petala_healthcare
      icon: personal_injury
      note: Patient demographics and medical history
      display_template: "{{first_name}} {{last_name}} - MRN: {{mrn}}"
      sort: 1

    schema:
      schema:
        name: patients
        comment: Healthcare patient records

      fields:
        - field: id
          type: uuid
          schema:
            is_primary_key: true

        - field: status
          type: string
          schema:
            default_value: active
          meta:
            interface: select-dropdown
            options:
              choices:
                - { text: Active, value: active }
                - { text: Inactive, value: inactive }
                - { text: Deceased, value: deceased }

        - field: tenant_id
          type: uuid
          schema:
            is_nullable: false

        - field: mrn
          type: string
          schema:
            is_nullable: false
            is_unique: true
            max_length: 50
          meta:
            note: Medical Record Number
            required: true

        # Demographics
        - field: first_name
          type: string
          schema:
            is_nullable: false
            max_length: 100
          meta:
            required: true

        - field: last_name
          type: string
          schema:
            is_nullable: false
            max_length: 100
          meta:
            required: true

        - field: date_of_birth
          type: date
          schema:
            is_nullable: false
          meta:
            interface: datetime
            required: true

        - field: gender
          type: string
          meta:
            interface: select-dropdown
            options:
              choices:
                - { text: Male, value: male }
                - { text: Female, value: female }
                - { text: Other, value: other }
                - { text: Prefer not to say, value: undisclosed }

        - field: blood_type
          type: string
          meta:
            interface: select-dropdown
            options:
              choices:
                - { text: A+, value: a_positive }
                - { text: A-, value: a_negative }
                - { text: B+, value: b_positive }
                - { text: B-, value: b_negative }
                - { text: AB+, value: ab_positive }
                - { text: AB-, value: ab_negative }
                - { text: O+, value: o_positive }
                - { text: O-, value: o_negative }

        # Contact Information
        - field: email
          type: string
          schema:
            max_length: 255
          meta:
            interface: input
            options:
              type: email

        - field: phone
          type: string
          schema:
            max_length: 50
          meta:
            required: true

        - field: address
          type: text
          meta:
            interface: input-multiline

        - field: city
          type: string
          schema:
            max_length: 100

        - field: state
          type: string
          schema:
            max_length: 50

        - field: zip_code
          type: string
          schema:
            max_length: 20

        - field: country
          type: string
          schema:
            max_length: 100

        # Emergency Contact
        - field: emergency_contact_name
          type: string
          schema:
            max_length: 200

        - field: emergency_contact_phone
          type: string
          schema:
            max_length: 50

        - field: emergency_contact_relationship
          type: string
          schema:
            max_length: 100

        # Insurance
        - field: insurance_provider
          type: string
          schema:
            max_length: 200

        - field: insurance_policy_number
          type: string
          schema:
            max_length: 100

        - field: insurance_group_number
          type: string
          schema:
            max_length: 100

        # Medical Information
        - field: allergies
          type: text
          meta:
            interface: input-multiline
            note: List of known allergies

        - field: chronic_conditions
          type: text
          meta:
            interface: input-multiline
            note: List of chronic conditions

        - field: current_medications
          type: text
          meta:
            interface: input-multiline

        # Primary Care
        - field: primary_physician_id
          type: uuid
          meta:
            interface: select-dropdown-m2o

        # Statistics
        - field: last_visit_date
          type: timestamp

        - field: total_visits
          type: integer
          schema:
            default_value: 0

        - field: date_created
          type: timestamp
          meta:
            special: [date-created]
            readonly: true

        - field: date_updated
          type: timestamp
          meta:
            special: [date-updated]
            readonly: true

        - field: user_created
          type: uuid
          meta:
            special: [user-created]
            readonly: true

        - field: user_updated
          type: uuid
          meta:
            special: [user-updated]
            readonly: true
